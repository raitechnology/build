<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Rai Protocol for Cache Backed Pub Sub</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Rai Protocol for Cache Backed Pub Sub</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_about">About</a></li>
<li><a href="#_subscription_operations">Subscription Operations</a>
<ul class="sectlevel2">
<li><a href="#_subscription_listen">Subscription Listen</a></li>
<li><a href="#_subscription_intial">Subscription Intial</a></li>
<li><a href="#_snapshot_intial">Snapshot Intial</a></li>
<li><a href="#_unsubscribe">Unsubscribe</a></li>
<li><a href="#_reassert_subscription">Reassert Subscription</a></li>
</ul>
</li>
<li><a href="#_update_messaging">Update Messaging</a>
<ul class="sectlevel2">
<li><a href="#_update_publish">Update Publish</a></li>
<li><a href="#_refresh_initial">Refresh Initial</a></li>
<li><a href="#_drop_notification">Drop Notification</a></li>
<li><a href="#_stale_notification">Stale Notification</a></li>
<li><a href="#_not_found_notification">Not Found Notification</a></li>
<li><a href="#_verify_notification">Verify Notification</a></li>
<li><a href="#_feed_down">Feed Down</a></li>
<li><a href="#_feed_switch">Feed Switch</a></li>
<li><a href="#_subscription_expired">Subscription Expired</a></li>
<li><a href="#_subject_renamed">Subject Renamed</a></li>
<li><a href="#_recap_publish">Recap Publish</a></li>
<li><a href="#_conflated_publish">Conflated Publish</a></li>
</ul>
</li>
<li><a href="#_other_services">Other Services</a>
<ul class="sectlevel2">
<li><a href="#_dictionary">Dictionary</a></li>
<li><a href="#_entitlements">Entitlements</a></li>
<li><a href="#_service_directory">Service Directory</a></li>
</ul>
</li>
<li><a href="#_protocols_supported">Protocols Supported</a>
<ul class="sectlevel2">
<li><a href="#_rv">RV</a></li>
<li><a href="#_nats">NATS</a></li>
<li><a href="#_redis">Redis</a></li>
<li><a href="#_httpwebsocket">Http/Websocket</a></li>
<li><a href="#_openpgm">OpenPGM</a></li>
</ul>
</li>
<li><a href="#Legacy">Legacy RV SASS2 and SASS3</a>
<ul class="sectlevel2">
<li><a href="#_overview">Overview</a></li>
<li><a href="#_subscription_listenunsubscribe">Subscription Listen/Unsubscribe</a></li>
<li><a href="#_reassert_subscription_2">Reassert Subscription</a></li>
<li><a href="#_subscription_initialsnapshot">Subscription Initial/Snapshot</a></li>
<li><a href="#_update_publish_2">Update Publish</a></li>
<li><a href="#_drop_notification_2">Drop Notification</a></li>
<li><a href="#_subcription_expired">Subcription Expired</a></li>
<li><a href="#_subject_renamed_2">Subject Renamed</a></li>
<li><a href="#_stale_notification_2">Stale Notification</a></li>
</ul>
</li>
<li><a href="#_security">Security</a>
<ul class="sectlevel2">
<li><a href="#_hmac_authentication">HMAC Authentication</a></li>
</ul>
</li>
<li><a href="#Format">Message Presentation</a></li>
<li><a href="#_protocol_initialization">Protocol Initialization</a>
<ul class="sectlevel2">
<li><a href="#_bert_and_ernie">Bert and Ernie</a></li>
<li><a href="#_inbox_subjects">Inbox Subjects</a></li>
<li><a href="#_session_notification">Session Notification</a></li>
</ul>
</li>
<li><a href="#_subscription_operations_2">Subscription Operations</a>
<ul class="sectlevel2">
<li><a href="#_subscription_notification">Subscription Notification</a></li>
<li><a href="#_reassert_subscription_3">Reassert Subscription</a></li>
<li><a href="#_snapshot_request">Snapshot Request</a></li>
</ul>
</li>
<li><a href="#_update_messaging_2">Update Messaging</a>
<ul class="sectlevel2">
<li><a href="#_update_publish_3">Update Publish</a></li>
<li><a href="#_drop_notification_3">Drop Notification</a></li>
<li><a href="#_not_found_notification_2">Not Found Notification</a></li>
<li><a href="#_conflated_stale_publish">Conflated, Stale Publish</a></li>
<li><a href="#_feed_switch_notification">Feed Switch Notification</a></li>
</ul>
</li>
<li><a href="#_type_and_status_usage">Type and Status Usage</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_about">About</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes a caching layer on top of existing pubsub systems.
Pubsub provides for a multiplexed subject adressed based stream of messages
from publisher to subscriber.  Pubsub is usually layered on top of a reliable
based transport, such as <strong>TCP</strong> or <strong>PGM</strong>.  The multicast supported by the
architectures is either point to point <strong>TCP</strong> fanout of subscription interest or
built on top of a reliable multicast <strong>UDP</strong> transport.  The publisher can be a
feed service, performing last value caching and trasforming the events into
subject streams, or it may be a cache based router, which distrubutes publisher
services across multiple nodes in order to scale networks.</p>
</div>
<div class="paragraph">
<p>The caching layer includes methods for synchronizing state distributed across a
network of nodes.  The most important of this extended functionality is
subscription management, which includes methods beyond pubsub that allow for
network endpoints, the publisher and the subscriber, to encode cache semantics,
fault tolerance, and subscription visibility.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_subscription_operations">Subscription Operations</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_subscription_listen">Subscription Listen</h3>
<div class="paragraph">
<p>A message from a subscriber that multicasts to a well known endpoint with
notification of a subscripion start.  This message contains infromation
identifying the subscriber uniquely.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subscription_intial">Subscription Intial</h3>
<div class="paragraph">
<p>This extends the subscription listen to also provide a subscriber endpoint for
intializing the image associated with the subscription.</p>
</div>
</div>
<div class="sect2">
<h3 id="_snapshot_intial">Snapshot Intial</h3>
<div class="paragraph">
<p>A one time request for the current state of the cached image.</p>
</div>
</div>
<div class="sect2">
<h3 id="_unsubscribe">Unsubscribe</h3>
<div class="paragraph">
<p>This message multicasts to the well known endpoint with a notification of a
subscription stop using the unique identification sent with the subscription
start.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reassert_subscription">Reassert Subscription</h3>
<div class="paragraph">
<p>This message resets any timers associated with subscription by the publisher.
A publisher may drop subscriptions that have not been active after a period of
time.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_update_messaging">Update Messaging</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_update_publish">Update Publish</h3>
<div class="paragraph">
<p>After one or more subscription interestes are known, the publisher provides
updates to the subscription.</p>
</div>
</div>
<div class="sect2">
<h3 id="_refresh_initial">Refresh Initial</h3>
<div class="paragraph">
<p>In the event that a subject stream is disrupted by network or node failure,
this reestablishes the initial state of the subject, which has become stale.</p>
</div>
</div>
<div class="sect2">
<h3 id="_drop_notification">Drop Notification</h3>
<div class="paragraph">
<p>In the event that a subscription timer expires, this notifies any subscriber
that may be active that the publisher dropped the subscription and is no longer
forwarding messages.  If a subscriber is still active, it must reasert or
restart the subscription.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stale_notification">Stale Notification</h3>
<div class="paragraph">
<p>If the publisher is no longer able to provide updates or has lost sequences of
messages associated with a subject, this notifies the subscriber that the
current state is stale.  This may cause subsribers to restart a subscription on
another path or they may need to wait for the publisher to restore the subject
stream.</p>
</div>
</div>
<div class="sect2">
<h3 id="_not_found_notification">Not Found Notification</h3>
<div class="paragraph">
<p>When a subscription listen starts, this reply notifies the subscriber that the
subscription is established, but that no published data is currently available.</p>
</div>
</div>
<div class="sect2">
<h3 id="_verify_notification">Verify Notification</h3>
<div class="paragraph">
<p>Another form of subscription listen start reply where the publisher notifies
that no published data is available, but is expected to be ready soon.  This
often includes a zeroed record associated with the subject so that the
subscriber can initialize its internal state and be ready for updates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_feed_down">Feed Down</h3>
<div class="paragraph">
<p>A form of stale notification that may include information about the publisher
state.</p>
</div>
</div>
<div class="sect2">
<h3 id="_feed_switch">Feed Switch</h3>
<div class="paragraph">
<p>A form of stale notification that indicates a gap or duplication of the stream
may occur as the source path of the stream has changed, such as a primary to
secondary flip.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subscription_expired">Subscription Expired</h3>
<div class="paragraph">
<p>If a subject stream is permanently ended, this notifies that the publisher no
longer intends send updates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subject_renamed">Subject Renamed</h3>
<div class="paragraph">
<p>When a subject stream is renamed to another, this message identifies which
subject should be subscribed to reestablish the stream.</p>
</div>
</div>
<div class="sect2">
<h3 id="_recap_publish">Recap Publish</h3>
<div class="paragraph">
<p>When a feed switch, or primary to secondary flip, occurs, a recap of the latest
updates are published in order to insure that the stream is up to date.  These
messages can be combined so that all of the data up to the last published
update are recapped for the configured time period.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conflated_publish">Conflated Publish</h3>
<div class="paragraph">
<p>If a subject stream has reduced bandwidth, a conflated message encodes multiple
updates into a single update.  This allows a publisher to increase the
reliability with a reduction in message rate when the latency of updates is not
as important.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_services">Other Services</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dictionary">Dictionary</h3>
<div class="paragraph">
<p>If a dictionary is associated with the messages sent, this well known endpoint
can be used by subscribers to download the latest dictionary.  If a dictionary
is not static, subscription for dictionary updates is also started.</p>
</div>
</div>
<div class="sect2">
<h3 id="_entitlements">Entitlements</h3>
<div class="paragraph">
<p>When a system is designed for licensed access to data, it is necessary to track
the activity of the subscriber.  This service endpoint encodes the access
levels and the logging of subscription events.</p>
</div>
</div>
<div class="sect2">
<h3 id="_service_directory">Service Directory</h3>
<div class="paragraph">
<p>A subject space is often divided into seperate services, each with it&#8217;s own
well known endpoint for establishing a subscriptions.  Traditionally, the first
segment of the subject identifies the publsher.  For example, NASDAQ may be
used to establish subscriptions published by the NASDAQ feed, and NYSE may be
used for the NYSE feed.  The service directory names all of the publishers by
their subject prefix.  It should also define the dictionary and entitlements
well known endpoints if they are desired.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_protocols_supported">Protocols Supported</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The target systems, except for <strong>RV</strong> employ text based publish and subscribe
primitives.  For this reason, the protocol for supporting extended semantics
should have a text base, with an equivalent binary format.  This is expanded
in <a href="#Format">Message Presentation</a>.</p>
</div>
<div class="sect2">
<h3 id="_rv">RV</h3>
<div class="paragraph">
<p>The <strong>SASS2</strong> and <strong>SASS3</strong> protocols are built on top of RV, but are not natively
equiped to to deal with the some of field types needed such as a decimal type
that maintains the precision of the numerical data.  In most cases, the system
that need these types, use alternative message formats passed in <strong>OPAQUE</strong>
fields.</p>
</div>
<div class="paragraph">
<p>The <a href="#Legacy">Legacy RV SASS2 and SASS3</a> section below describes how the <strong>SASS2</strong> and <strong>SASS3</strong> protocols
work.  The goal of this section is to show the strengths and the weaknesses of
these and inform the design of the protocol layers needed to extend the other
protocols.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nats">NATS</h3>
<div class="paragraph">
<p>NATS does not natively have subscription management, so much of the caching
semantics has to be layered on top of the base pubsub system.  The subject
encoding scheme is mostly <strong>RV</strong> compatible, with the exception of publishing
messages to wildcard subjects, which is forbidden.</p>
</div>
</div>
<div class="sect2">
<h3 id="_redis">Redis</h3>
<div class="paragraph">
<p>Redis also does not nately have subscripton management, but it does have a
complex array of caching semantics that may be used.  The subject encoding
is string based with shell style wildcards.  Users <strong>Redis</strong> often segment
the channels (subjects) using a <em>:</em> separator.</p>
</div>
</div>
<div class="sect2">
<h3 id="_httpwebsocket">Http/Websocket</h3>
<div class="paragraph">
<p>This is basically the same as the Redis case, since the caching semantics
works as the Redis RESP protocol is layered over the Websocket protocol.</p>
</div>
</div>
<div class="sect2">
<h3 id="_openpgm">OpenPGM</h3>
<div class="paragraph">
<p>This is a transport, not a pubsub sytem.  The history of PGM flows through
early caching systems by Tibco, to RFC, to open source.  A pubsub layer could
design any subject encoding scheme.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Legacy">Legacy RV SASS2 and SASS3</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview">Overview</h3>
<div class="paragraph">
<p>With the <strong>SASS2</strong> base, most of the RV architecture already supports many of the
features needed for subscription visibility and identifying the subscriber.
The most annoying features of <strong>SASS</strong> is the static dictionary and the lack of
formalizing the sequence numbers of the updates.  There are two forms of
sequencing which use the same <strong>SEQ_NO</strong> field.  The publisher may use the
<strong>SEQ_NO</strong> field for sequencing the stream of data, across multiple subjects but
the subscriber needs the sequencing for each subject.  This segmentation
requires subscriber to know what variation of sequencing is used in order to
verify the sequences of updates.</p>
</div>
<div class="paragraph">
<p>The <strong>SASS2</strong> header includes <strong>MSG_TYPE</strong>, <strong>REC_TYPE</strong>, <strong>SEQ_NO</strong>, <strong>REC_STATUS</strong>.
The <strong>MSG_TYPE</strong>, <strong>REC_STATUS</strong> fields encode the basic response types needed,
with an optional status <strong>TEXT</strong> field for descriptions.  The <strong>REC_TYPE</strong> is
deprecated as an advisory field, as support for dictionary based record
encoding as been erroded by field additions and the pain of updating a static
dictionary in a distributed system.</p>
</div>
<div class="paragraph">
<p>The subscription management is built into the RV system.  Each unique endpoint
identifies itself using the IP address of the interface and a timestamp of the
daemon startup.  The subscriptions are reasserted every 90 seconds by
publishing a <strong>HOST.STATUS</strong> message.  When the transport is disrupted, the
subscriptions can be obtained from the host by querying it.  Each host is
reachable on a well known subject <strong>_INBOX.hostip.DAEMON</strong>.  The main drawback of
this management method is the 90 seconds interval, which can lead to long
periods of outages bounded by 90 second intervals before a subject stream
reestablishes the cached state.  Any switch or network element in between the
subscriber and the publisher which drops the multicast <strong>UDP</strong> packets can cause
a a long disruption in the subscriptions that were dropped.</p>
</div>
<div class="paragraph">
<p>The advantages of <strong>SASS2</strong> are that it is a low overhead system without a lot of
subscription management traffic during normal operation.  The successor to
<strong>SASS2</strong>, called <strong>SASS3</strong>, adds reassert type messages and each subscriber
publishes these on a randomized interval.  The <strong>_INBOX.hostip.DAEMON</strong> is no
longer supported since the Tibco archetecture introduced subject based routers
(rvrd) where the network <strong>IP</strong> addresses may be using <strong>NAT</strong> translation between
segments or may not be directly reachable through <strong>IP</strong> routers.  When these are
present, the <strong>_INBOX</strong> addresses used for point to point communication are
modified as they progress through the <strong>rvrd</strong> routers.  For example, a
<strong>_INBOX.hostip.timestamp.N</strong> subscriber endpoint is modified to be
<strong>_INBOX.routerip.timestamp._INBOX.hostip.timestamp.N</strong>.  This type of
infrastructure using <strong>rvrd</strong> is uncommon.  Reuters used its own method for
connecting across network boundaries through the use of it&#8217;s market data hub
products which contained the <strong>SASS2</strong> and <strong>SASS3</strong> protocols because the finance
portion of Tibco products were transfered to Reuters.</p>
</div>
</div>
<div class="sect2">
<h3 id="_subscription_listenunsubscribe">Subscription Listen/Unsubscribe</h3>
<div class="paragraph">
<p>The <strong>SASS2</strong> portion of the subscription mechanics are defined by the basic
operation of <strong>RV</strong>, they were organically defined in the original <strong>SASS</strong> market
data platform and evolved into <strong>RV</strong>.</p>
</div>
<div class="sect3">
<h4 id="_sass2_subscription_request"><strong>SASS2</strong> Subscription Request</h4>
<div class="paragraph">
<p>A subscription generates this message:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_RV.INFO.SYSTEM.LISTEN.START.subject : {
  return : _INBOX.hostip.timestamp.N,
  data : {
    ADV_CLASS : INFO,
    ADV_SOURCE : SYSTEM,
    ADV_NAME : LISTEN.START.subject
    id : hostip.timestamp,
    sub : subject,
    refcnt : counter
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>sub</strong> and <strong>id</strong> fields identify the subject and the subscriber making the
subscription, the optional return field requests that an inital response is
desired.  In recent versions of the Tibrv API, it is not possible to specify
the return field in a subscription request.  The <strong>refcnt</strong> is incremented and
decremented by the same subscriber <strong>id</strong> starting the same subscription.  This
is uncommon since most Tib APIs will not allow this.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sass2_snapshot_request">SASS2 Snapshot Request</h4>
<div class="paragraph">
<p>A well known endpoint that receives:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SNAP.subject : {
  return : _INBOX.hostip.timestamp.N,
  flags : mask
}</pre>
</div>
</div>
<div class="paragraph">
<p>The snapshot image is returned to the <strong>_INBOX</strong> address.  The optional flags can
additionally specify that a subscription should start (flags = 6, the same as
the <strong>T</strong> flag in <strong>SASS3</strong> request described below).  This allows Tibrv API
subscriber to request an initial value with a return <strong>_INBOX</strong>, which is no
longer possible with the <strong>LISTEN.START</strong> message when using the Tibrv API.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sass2_unsubscribe_request">SASS2 Unsubscribe Request</h4>
<div class="paragraph">
<p>An unsubscribe generates this message:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_RV.INFO.SYSTEM.LISTEN.STOP.subject : {
  data : {
    ADV_CLASS : INFO,
    ADV_SOURCE : SYSTEM,
    ADV_NAME : LISTEN.STOP.subject,
    id : hostip.timestamp,
    sub : subject,
    refcnt : counter
  }
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sass3_subscription_request">SASS3 Subscription Request</h4>
<div class="paragraph">
<p>A well known endpoint is defined for each service on a subject domain, for
example, <strong>_SASS.NASDAQ.SUB</strong>.  This message is published by the subscriber for
subscription operations:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SASS.svc.SUB : {
  return : _INBOX.hostip.timestamp.N,
  data : {
    M : sub_magic,
    T : flags,
    A : {
      U : user,
      H : host,
      A : program,
      P : process-id
    }
    S : subject
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>sub_magic</strong> is always the value 23176.  The <strong>S</strong> and <strong>A</strong> fields identify the
subject and the subscriber making the subscription, and the <strong>T</strong> flags is a bit
mask identifing what operation is requested:</p>
</div>
<table class="tableblock frame-all grid-cols stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNAPSHOT_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBSCRIBE_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x02</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INITIAL_VALUES_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x04</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNSUBSCRIBE_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REFRESH_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESUBSCRIBE_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>A</strong> field is commonly combined into a string as <strong>user@host/program#pid</strong>.
This endpoint merges the basic subscription operations: Subscription,
Subscription Image, Snapshot, Refresh Image, Subscription Reassert,
Unsubscribe.  The advantages of a <strong>SASS3</strong> request are that the subsccriber is
identified by a readable string rather than a hostip and timestamp and that
many of the operators for asserting subscriptions are combined into one
publish.  The disadvantage is that the service endpoint needs to be defined and
the host field does not need to identify the IP address of the subscribers
making the request.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reassert_subscription_2">Reassert Subscription</h3>
<div class="sect3">
<h4 id="_sass2_reassert_subscription">SASS2 Reassert Subscription</h4>
<div class="paragraph">
<p>A <strong>SASS2</strong> subscription managment database is necessary to ensure that the
<strong>HOST.STATUS</strong> is updated every 90 seconds.  Every subscription contains an <strong>id</strong>
which identifies the daemon endpoint that can be queried to obtain the current
subscription state.  This is the <strong>HOST.STATUS</strong> message (missing some fields for
brevity):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_RV.INFO.SYSTEM.HOST.STATUS.hostip : {
  ADV_CLASS : INFO,
  ADV_SOURCE : SYSTEM,
  ADV_NAME : HOST.STATUS.hostip,
  hostaddr : ipaddress,
  time : milliseconds,
  service : service-number,
  network : network-spec
  ...
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>hostip</strong> part of the subject reasserts all subscriptions with the <strong>id</strong>
<strong>hostip.timestamp</strong> or <strong>hostip.DAEMON.timestamp</strong>, which were specified by the
<strong>LISTEN.START</strong> message.  If there is message loss on the transport or the
<strong>HOST.STATUS</strong> message does not get received by the subscription manager at the
time expected, it uses point to point requests to retrieve the current
subscription state.</p>
</div>
<div class="paragraph">
<p>There are two queries to obtain the state of subscriptions, the session
query and the subscription query.  The session query lists the subscriber
sessions attached to a daemon.  The subscription query lists the subject
attached to a session(s).</p>
</div>
<div class="paragraph">
<p>The format of the session state queries are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.DAEMON : {
  return : _INBOX.hostip.timestamp.N,
  data : {
    op : get,
    what : sessions
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The format of the subscripion state queries are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.DAEMON : {
  return : _INBOX.hostip.timestamp.N,
  data : {
    op : get,
    what : subscriptions,
    session : hostip.timestamp
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The return of the session state query is a list of sessions, which match
the <strong>id</strong> of the <strong>LISTEN.START</strong> notifications:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  null : hostip.DAEMON.timestamp,
  null : hostip.timestamp,
  null : hostip.timestamp
}</pre>
</div>
</div>
<div class="paragraph">
<p>Each of these sessions can be used to retrieve the subscriptions using the
subscription state query above, this returns a list of subjects:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  user : nobody
  null : subject
  null : subject
  end  : 1
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sass3_reassert_subscription">SASS3 Reassert Subscription</h4>
<div class="paragraph">
<p>The <strong>_SASS.svc.SUB</strong> method of starting subscriptions can contain a list of
subjects.  Although the list can be used to mass start or stop subscriptions,
the primary use is to reassert them.  After the list is processed by the
manager, an <strong>ACK</strong> is published to the return subject.  If this message is used
for reassert:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SASS.svc.SUB : {
  return : _INBOX.hostip.timestamp.N,
  data : {
    M : sub_magic,
    T : RESUBSCRIBE_FLAG,
    A : {
      U : user,
      H : host,
      A : program,
      P : process-id
    }
    S : subject1,
    S : subject2,
    S : subject3
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>T</strong> field is the same as the <strong>SASS3</strong> subscription request above, where 0x80
is the mask bit for <strong>RESUBSCRIBE_FLAG</strong>.</p>
</div>
<div class="paragraph">
<p>After processing the reassert message, the publisher sends an <strong>ACK</strong> to the
return subject:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  data : {
    M : pub_magic,
    I : 0x20,
    T : VERIFY,
    S : OK,
    D : {
      S : subject1,
      S : subject2,
      S : subject3
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>This is an active method of reasserting compared to the <strong>SASS2</strong> method.  The
advantage of <strong>SASS3</strong> is that the status of the subscriptions can be updated by
the manager as a list.  The <strong>T</strong> and the <strong>S</strong> fields are derived from the
<strong>MSG_TYPE</strong> and <strong>REC_STATUS</strong> fields of the updates.  The <strong>SASS2</strong> passive method
allows for simpler subscribers and both protocols will update the status of the
subjects via update publishes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subscription_initialsnapshot">Subscription Initial/Snapshot</h3>
<div class="paragraph">
<p>In all cases the initial value is sent point to point using the return argument
provided by the subscrtion start.  The first subject that is subscribed by a
<strong>RV</strong> subscriber when the connection is established to the daemon is the
<strong>_INBOX.hostip.timestamp.&gt;</strong> subject, which is globably unique in the <strong>rvd</strong>
subject domain (but not in rvrd&#8217;s).  All of the return values normally contain
this prefix, since the subscription is already started.  When an inbox is
provided by the Tib APIs, it is incrmenting an integer and appending it to the
base after the timestamp, for example <strong>_INBOX.hostip.timestamp.2</strong>.  The
<strong>_INBOX.hostip</strong> prefix also causes the subject to be routed over point to point
links instead of multicast.  Since the <strong>IP</strong> routing and the reliability of the
protocols is defined for each stream type, the point to point and mcast
messages arrive independent of one another, no ordering between them is
guarenteed.</p>
</div>
<div class="sect3">
<h4 id="_sass2_initialsnapshot">SASS2 Initial/Snapshot</h4>
<div class="paragraph">
<p>The message arriving using the return subject does not contain the original
subscription subject, so this mapping of <strong>_INBOX</strong> string to subject must be
maintained by the subscriber.  The <strong>SASS</strong> header <strong>MSG_TYPE</strong> is usually modified
by the publisher to indicate what kind of data is present, either <strong>INITIAL</strong> of
<strong>SNAPSHOT</strong> is a normal response, and others have special status, <strong>TRANSIENT</strong> is
used for not found or not available, <strong>DROP</strong> is used when a subject is expired
and no longer available, <strong>VERIFY</strong> is used to prepare the subscriber for
updates.  In addition, the <strong>REC_STATUS</strong> field may contain <strong>STALE</strong> for out of
date records, <strong>NOT_FOUND</strong> when no record is present, <strong>TEMP_UNAVAIL</strong>,
<strong>BAD_NAME</strong>, <strong>BAD_LINE</strong>, <strong>FEED_DOWN</strong> for publisher errors that are not normal.
Other values can be used by the publishers, depending on the data source and
the publisher implementation.</p>
</div>
<div class="paragraph">
<p>A normal return value is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  MSG_TYPE : INTIAL,
  REC_TYPE : NMTS,
  SEQ_NO : 1001,
  REC_STATUS : OK,
  &lt;msg data&gt;
}</pre>
</div>
</div>
<div class="paragraph">
<p>A Not Found return value is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  MSG_TYPE : TRANSIENT
  REC_STATUS : NOT_FOUND
}</pre>
</div>
</div>
<div class="paragraph">
<p>A Stale return value is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  MSG_TYPE : INTIAL,
  REC_TYPE : NMTS,
  SEQ_NO : 1001,
  REC_STATUS : STALE,
  &lt;other data fields&gt;
}</pre>
</div>
</div>
<div class="paragraph">
<p>The only difference for a snapshot is the <strong>MSG_TYPE</strong>, which will contain
<strong>SNAPSHOT</strong> instead of <strong>INITIAL</strong> in the case that a data value is returned.
The <strong>REC_TYPE</strong> does not need to be defined anymore, so it may be absent or
zero.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sass3_initialsnapshot">SASS3 Initial/Snapshot</h4>
<div class="paragraph">
<p>The <strong>SASS3</strong> protocol uses an header envelope which has the same semantics as
<strong>SASS2</strong>, but the coding of the record can be in <strong>Marketfeed</strong> format in addition
to the <strong>SASS2</strong> formats, which are <strong>TibMsg</strong> or <strong>SASS Qform</strong>.  This format may
not have the same status fields of <strong>MSG_TYPE</strong> and <strong>REC_STATUS</strong>.  The <strong>SASS3</strong>
envelope still uses the same status value as <strong>SASS2</strong>.  This is a normal return
value:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  M : pub_magic,
  T : INITIAL,
  S : OK
  D : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>pub_magic</strong> is always the value 23177.  The <strong>T</strong> field is equivalent to the
<strong>MSG_TYPE</strong> field and the <strong>S</strong> field is equivalent to the <strong>REC_STATUS</strong> field.</p>
</div>
<div class="paragraph">
<p>A Not Found return value is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  M : pub_magic,
  T : TRANSIENT,
  S : NOT_FOUND
}</pre>
</div>
</div>
<div class="paragraph">
<p>A Stale return value is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.hostip.timestamp.N : {
  M : pub_magic,
  T : INITIAL,
  S : STALE,
  D : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_update_publish_2">Update Publish</h3>
<div class="paragraph">
<p>Updates are multicast to the subscription.  These are delta changes to the
initial value.  It may be an <strong>INITIAL</strong> indicating all fields are present or
some other type with a subset of the fields.  An <strong>INITIAL</strong> is often used when
the publisher adds or removes a field from the initial value, or wants to
ensure that the subscribers are up to date by publishing the inital on a timer.</p>
</div>
<div class="paragraph">
<p>A <strong>SASS2</strong> update contains the same header as the initial with the <strong>MSG_TYPE</strong>
usually set to <strong>UPDATE</strong> or a status that is has additional semantics to that,
such as <strong>CORRECT</strong> or <strong>CLOSING</strong>.</p>
</div>
<div class="sect3">
<h4 id="_sass2_update">SASS2 Update</h4>
<div class="literalblock">
<div class="content">
<pre>NASDAQ.REC.INTC.O : {
  MSG_TYPE : UPDATE,
  REC_TYPE : NMTS,
  SEQ_NO : 1002,
  REC_STATUS : OK,
  &lt;msg data&gt;
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sass3_update">SASS3 Update</h4>
<div class="literalblock">
<div class="content">
<pre>NASDAQ.REC.INTC.O : {
  M : pub_magic,
  T : UPDATE,
  S : OK,
  D : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>SASS3</strong> case may omit the <strong>T</strong> and <strong>S</strong> fields as they default to these
values when not present.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_drop_notification_2">Drop Notification</h3>
<div class="paragraph">
<p>A <strong>MSG_TYPE</strong> which contains a <strong>DROP</strong> code indicates that the publisher is not
going to update a subject.  The subscription itself stays open until the
subscriber closes it.  When the <strong>REC_STATUS</strong> contains the status for
<strong>NOSUBSCRIBERS</strong>, the publisher has no active subscribers in the subscription
management database and reasserting the subscription will restart it.  This
case is rarely seen by subscribers unless they are using a wildcard.  All the
other <strong>REC_STATUS</strong> codes can only be reestablished by reasserting when the
subject state is reinitialized.  The subscriber can try, but the result is
usually a <strong>NOT_FOUND</strong> status.</p>
</div>
<div class="sect3">
<h4 id="_sass2_drop">SASS2 Drop</h4>
<div class="paragraph">
<p>This is the subscription managment notification:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>NASDAQ.REC.INTC.O : {
  MSG_TYPE : DROP,
  REC_STATUS : NOSUBSCRIBERS
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sass3_drop">SASS3 Drop</h4>
<div class="paragraph">
<p>The <strong>SASS3</strong> case is the same as <strong>SASS2</strong> with the envelope <strong>T</strong> and <strong>S</strong> fields
set appropriately.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subcription_expired">Subcription Expired</h3>
<div class="paragraph">
<p>These are often sent when a subject bounded by a date expires.</p>
</div>
<div class="sect3">
<h4 id="_sass2_expire">SASS2 Expire</h4>
<div class="paragraph">
<p>This is the publisher ceasing updates on a subject:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>NASDAQ.REC.INTC.O : {
  MSG_TYPE : DROP,
  REC_STATUS : EXPIRED
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_subject_renamed_2">Subject Renamed</h3>
<div class="paragraph">
<p>When a subject is moved to another, this is used to notify the subscribers.</p>
</div>
<div class="sect3">
<h4 id="_sass2_relocate">SASS2 Relocate</h4>
<div class="paragraph">
<p>This is the publisher reassigning the subject to another name:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>NASDAQ.REC.INTC.O : {
  MSG_TYPE : DROP,
  REC_STATUS : RELOCATE,
  TEXT : NASDAQ.REC.MSFT.O
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stale_notification_2">Stale Notification</h3>
<div class="paragraph">
<p>A <strong>STALE</strong> notification is set in a <strong>REC_STATUS</strong> through normal update publishes
or through initial values.  It is stored with the record and is cleared only
when an <strong>INITIAL</strong> or a <strong>VERIFY</strong> clears it.  The reason for this is that a cache
does not know which field is out of date, so updates to the record are applied
and forwarded but the <strong>STALE</strong> status persists.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security">Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The transports above, mostly have <strong>TLS</strong> based security, and secure tunnels
could be setup between nodes at the <strong>IP</strong> routing layer 3, so encryption of the
transport is not a part of the security methods described here.</p>
</div>
<div class="sect2">
<h3 id="_hmac_authentication">HMAC Authentication</h3>
<div class="paragraph">
<p>This security is for the messaging layer to authenticate the publisher to the
subscribers.  The subscribers must be able to trust the messages as unmodified,
uniquely serialized, and authentic.</p>
</div>
<div class="paragraph">
<p>A <strong>HMAC</strong> can be used to do this.  The user identity, the session instance, and
the seqno serialization of the subject&#8217;s messages will be unique to the
publisher.</p>
</div>
<div class="paragraph">
<p>Each node has a database of users and services:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[
  { user : user1, svc : service1, hash : HA0 },
  { user : user2, svc : service1, hash : HA0 },
  { user : user3, svc : service1, hash : HA0 }
]</pre>
</div>
</div>
<div class="paragraph">
<p>Where each service identifies a subject domain:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[
  { svc : service1,
    route : {
      type : nats,
      url : nats://127.0.0.1:4222,
      name : route,
      user : xyz,
      pass : abc,
      auth_token : tok
    }
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>service1</strong> name and the hash <strong>HA0</strong> are not published.  The <strong>HA0</strong> is a hash
of a password which may be unique to <strong>user1</strong> and the password is not stored on
any node.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HA0 = SHA256( user1 + service1 + password )
HA1 = SHA256( HA0 + nonce )</pre>
</div>
</div>
<div class="paragraph">
<p>Each message can then be authenticated to be published from the node using
<strong>user1.nonce</strong> as the session prefix and using the <strong>HA1</strong> hash as the key in a
<strong>HMAC</strong> with the subject and message data resulting in the <strong>HA2</strong> hash.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HA2 = AES_HASH( IV = seqno, MSG = subject + message-data )
digest = HMAC_AES( K = HA1, MSG = HA2 )</pre>
</div>
</div>
<div class="paragraph">
<p>The result is a <strong>HMAC</strong> authenticated message:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>subject : {
  session : user1.nonce,
  seqno : sequence,
  digest : digest_bits,
  data {
    message-data
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>When the subscriber recieves this message, it is verified by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>seqno</strong> must be greater than the <strong>subjects</strong> last message published by
the <strong>user1.nonce</strong> session to protect against replays.</p>
</li>
<li>
<p>The <strong>user1.service1</strong> must exist in the node database so that <strong>HA0</strong> can be
computed to <strong>HA1</strong> using the session&#8217;s <strong>nonce</strong> and that can be used to
verify the <strong>digest</strong>.</p>
</li>
<li>
<p>The <strong>digest</strong> can be recomputed using <strong>HA0</strong>, <strong>HA1</strong> and <strong>HA2</strong> by:</p>
<div class="literalblock">
<div class="content">
<pre>HA2 = AES_HASH( IV = seqno, MSG = subject + message-data )
HA0 = node_database[ user1.service1 ]
HA1 = SHA256( HA0 + nonce )
hmac-result = HMAC_AES( K = HA1, MSG = HA2 )</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To authenticate the message came from <strong>user1.service1</strong>, compare <strong>hmac-result</strong>
with <strong>digest</strong> in the message.  Since <strong>HA2</strong> is a property of the message, it can
be used to encode the <strong>HMAC</strong> for other transport endpoints.  <strong>HA1</strong> is a hash of
<strong>HA0</strong> and a <strong>nonce</strong> which is unique to the session endpoint for <strong>user1</strong>, it can
be computed when the session starts.  For each unique publisher that a
subscriber encounters, a <strong>HA1</strong> hash can be computed and cached with the
transport when more messages are expected to be published from the same
session.  This reduces the cost of authentication to a <strong>AES_HASH</strong> of the
message data and a <strong>HMAC_AES</strong> digest computation, and both can be accelerated
using <strong>AES</strong> instructions built into the CPU.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Format">Message Presentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The text base that is most natural is a relaxed version of <strong>JSON</strong> used in
javascript.  The recursive field value notation of objects is compatable with
recursive self describing messaging binary formats.  The header fields required
should be limited to strings and integers so that <strong>RV</strong> message format can be
used without loss of semantics.  The other types of fields, such as dates,
times, decimals, etc, should have a field dictionary in order to transform
from <strong>JSON</strong> strings without losing information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_protocol_initialization">Protocol Initialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A session should be initialized at the start with a session and an inbox.</p>
</div>
<div class="sect2">
<h3 id="_bert_and_ernie">Bert and Ernie</h3>
<div class="paragraph">
<p>The users used below are bert and ernie, where bert is the subscriber and ernie
is the publisher.</p>
</div>
</div>
<div class="sect2">
<h3 id="_inbox_subjects">Inbox Subjects</h3>
<div class="paragraph">
<p>A subscribion to an inbox endpoint, which made of an inbox prefix, a user
id, and a random or time based nonce.  A random nonce is preferred so that the
system clock is not used for uniqueness and authenticating.</p>
</div>
<div class="paragraph">
<p>An <strong>RV</strong> based inbox is based on the host ip address, the system clock in
seconds, the process id, and an address in the process space.  If the system
clock is reset, such as a machine rebooting, it is possible that it will
repeat.  The other systems can use other means.  A subject compatible user id
is mobile and does not need to be tied to a single host ip address.  The nonce
can be derived from a random source with enough bits, it can provide sufficient
uniqueness and security for authentication.</p>
</div>
<div class="paragraph">
<p>If another transport is used for <strong>_INBOX</strong> point to point messages, that can be
specified in the session messages.  Since the <strong>TCP</strong> based protocols are by
their nature point to point, this only applies to <strong>UDP</strong> mcast trasports like
<strong>OpenPGM</strong>.  The <strong>_INBOX</strong> subjects are unique in the subject space, so they
can be mcast.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.USER.NONCE.&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This endpoint is used when a message is sent from node to node.  A return
can be truncated to subject without the prefix:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SNAP.subject : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  return : 1
}</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the return would be the <strong>_INBOX.bert.NONCE.1</strong>.  If a full subject
is desired instead of the inbox session, a <strong>return_sub</strong> field can be used
instead of a <strong>return</strong>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SNAP.subject : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  return_sub : ANOTHER.SUBJECT
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_session_notification">Session Notification</h3>
<div class="paragraph">
<p>A publish to a well known subject indicating a session start.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SESSION.HELLO : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  ucast_url : pgm://host:port,
  time : utc_usecs,
  interval : secs
}</pre>
</div>
</div>
<div class="paragraph">
<p>The interval is a heartbeat that keeps the sessions subscriptions alive.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SESSION.HB : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  ucast_url : pgm://host:port,
  time : utc_usecs,
  interval : secs
}</pre>
</div>
</div>
<div class="paragraph">
<p>And session stop notification causes the publishers to drop the subscriptions
associated with the session.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SESSION.BYE : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_subscription_operations_2">Subscription Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The subsciption protocol can be relatively chatty is desired, with <strong>ack</strong> results
so that the subcribers are informed of progress by the publishers.</p>
</div>
<div class="sect2">
<h3 id="_subscription_notification">Subscription Notification</h3>
<div class="paragraph">
<p>A subscription <strong>start</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SUB.START.subject : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  return : 1,
  initial : true,
  ack : true,
  expires : secs
}</pre>
</div>
</div>
<div class="paragraph">
<p>The expires is how long the subscription should be alive before it expires
after the last <strong>_SESSION.HB</strong> was seen by the publishers.  The <strong>return</strong> field is
specified if an initial value is wanted indicated by the <strong>initial</strong> field.  An
<strong>ack</strong> can be requested to notify that the subscription was seen by a publisher.
This would be useful when the subscription is expected to take some time or if
no initial is desired.</p>
</div>
<div class="paragraph">
<p>An <strong>ack</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.bert.NONCE.1 : {
  session : ernie.NONCE,
  seqno : sequence,
  type : start,
  subject : subject,
  status : ack
}</pre>
</div>
</div>
<div class="paragraph">
<p>An <strong>initial</strong> value:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.bert.NONCE.1 : {
  session : ernie.NONCE,
  seqno : sequence,
  type : start,
  subject : subject,
  data : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>A subscription <strong>stop</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SUB.STOP.subject : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  return : 1,
  ack : true
}</pre>
</div>
</div>
<div class="paragraph">
<p>Like a subscription, a stop can request an <strong>ack</strong> return so that bert knows
that the publisher ernie has seen the <strong>stop</strong> message.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.bert.NONCE.1 : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  type : stop,
  subject : subject,
  status : ack
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reassert_subscription_3">Reassert Subscription</h3>
<div class="paragraph">
<p>If the publisher ernie misses a heartbeat from bert, a reassert query message
can be published to the subscriber bert at a randomized timer in the next
interval.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.bert.NONCE.get_subs : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  return : bert.subs,
  last_seen : utc_usecs,
  wildcard : &gt;
}</pre>
</div>
</div>
<div class="paragraph">
<p>If bert has subscriptions matching the wildcard since the last_seen time
(which is relative to bert&#8217;s own clock, not ernie&#8217;s), it should resend them to
ernie.  Bert can maintain a subscription window that expires after serveral
heartbeats are sent.  If the last_seen falls below the window, or is zero, then
all of the subscriptions are reasserted.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.ernie.NONCE.bert.subs : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  last_seen : utc_usecs,
  wildcard : &gt;,
  initial : true,
  ack : true,
  subs : [
    subject1, subject2, ...
  ],
  subs_return : [
    1, 2
  ]
}</pre>
</div>
</div>
<div class="paragraph">
<p>For each subject that ernie publishes, an <strong>ack</strong> is returned to bert as well as
the <strong>initial</strong> since both were specified.  The wildcard is useful since the
publishers may be listening to only a part of the subject space.</p>
</div>
</div>
<div class="sect2">
<h3 id="_snapshot_request">Snapshot Request</h3>
<div class="paragraph">
<p>A <strong>snapshot</strong> is uses a <strong>_SNAP</strong> prefix to indicate this is a request / reply.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_SNAP.subject : {
  session : bert.NONCE,
  seqno : sequence,
  digest : digest_bits,
  return : 1,
}</pre>
</div>
</div>
<div class="paragraph">
<p>The value returned would be a <strong>snapshot</strong> value:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.bert.NONCE.1 : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  type : snap,
  subject : subject,
  data : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_update_messaging_2">Update Messaging</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_update_publish_3">Update Publish</h3>
<div class="paragraph">
<p>The updates are mcast to the subject of the subscription.  An update is
implied when a <strong>type</strong> field is not present.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>subject : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  data : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_drop_notification_3">Drop Notification</h3>
<div class="paragraph">
<p>When a publisher has no subscribers left, a <strong>drop</strong> notification is mcast to
the subject.  The status is the reason for the drop.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>subject : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  type : drop
  status : nosubscribers
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_not_found_notification_2">Not Found Notification</h3>
<div class="paragraph">
<p>When an <strong>initial</strong> or a <strong>snapshot</strong> is reqeusted, the not found response is
sent as a reply.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>_INBOX.bert.NONCE.1 : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  type : snap,
  subject : subject,
  status : not_found
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conflated_stale_publish">Conflated, Stale Publish</h3>
<div class="paragraph">
<p>These are forms of an update where the publisher knows that multiple messages
are lost or merged into one update.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>subject : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  status : conflated,
  data  : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_feed_switch_notification">Feed Switch Notification</h3>
<div class="paragraph">
<p>This notification an advisory that may mean messages are missing or duplicated,
out of order, since the the source has changed.  An update may be published
with the fields that are recapped having arrived within the configured period.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>subject : {
  session : ernie.NONCE,
  seqno : sequence,
  digest : digest_bits,
  type : recap
  status : feed_switch
  data  : {
    &lt;msg data&gt;
  }
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_type_and_status_usage">Type and Status Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default values of type and status are <strong>update</strong> and <strong>ok</strong>.  The following are
the most useful of the type/status combinations.  There are many more status
codes that are defined, but are rarely used.  The type enumeration is the most
complete.  The caching semantics of <strong>initial</strong>, <strong>drop</strong>, <strong>update</strong>, <strong>verify</strong>,
<strong>snap</strong> are well defined without the need for other operators.  A <strong>transient</strong>
operator is the same as a status without message data.</p>
</div>
<table class="tableblock frame-all grid-cols stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">status</th>
<th class="tableblock halign-left valign-top">text</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ack requested with start request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ack requested with stop request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">snap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ok</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not_found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message not cached</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">temp_unavail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject timed out or connectivity issue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bad_access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject rejected by source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bad_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject naming scheme incompatable with source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value is old, incomplete</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">initial</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ok</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">verify</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message was reinitialized</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not_found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message not cached</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">temp_unvail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject timed out or connectivity issue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bad_access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject rejected by source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bad_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject naming scheme incompatable with source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">value is old, incomplete</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message merged updates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed_switch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new publisher, may have missing updates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">drop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nosubscribers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no subscribers left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expired</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the publisher is no longer updating subject</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relocate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">new subject name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">preempted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache full, message discarded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ok</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">updating stale message</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conflated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message merged updates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">feed_down</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject source is offline</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verify</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ok</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update that clears or validates fields</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-03-05 07:34:12 -0800
</div>
</div>
</body>
</html>